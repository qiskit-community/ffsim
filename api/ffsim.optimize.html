<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ffsim.optimize &#8212; ffsim 0.0.19.dev0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <script src="../_static/documentation_options.js?v=78e28295"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ffsim.random" href="ffsim.random.html" />
    <link rel="prev" title="ffsim.linalg" href="ffsim.linalg.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-ffsim.optimize">
<span id="ffsim-optimize"></span><h1>ffsim.optimize<a class="headerlink" href="#module-ffsim.optimize" title="Link to this heading">¶</a></h1>
<p>Optimization algorithms.</p>
<dl class="py function">
<dt class="sig sig-object py" id="ffsim.optimize.minimize_linear_method">
<span class="sig-prename descclassname"><span class="pre">ffsim.optimize.</span></span><span class="sig-name descname"><span class="pre">minimize_linear_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_to_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_hyperparameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_hyperparameters_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ffsim/optimize/linear_method.html#minimize_linear_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ffsim.optimize.minimize_linear_method" title="Link to this definition">¶</a></dt>
<dd><p>Minimize the energy of a variational ansatz using the linear method.</p>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/1412.0490">Implementation of the Linear Method for the optimization of Jastrow-Feenberg and Backflow Correlations</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_to_vec</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – Function representing the wavefunction ansatz. It takes as input
a vector of real-valued parameters and outputs the state vector represented
by those parameters.</p></li>
<li><p><strong>hamiltonian</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearOperator</span></code></span>) – The Hamiltonian representing the energy to be minimized.</p></li>
<li><p><strong>x0</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span>) – Initial guess for the parameters.</p></li>
<li><p><strong>maxiter</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Maximum number of optimization iterations to perform.</p></li>
<li><p><strong>regularization</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Hyperparameter controlling regularization of the
energy matrix. Its value must be positive. A larger value results in
greater regularization.</p></li>
<li><p><strong>variation</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Hyperparameter controlling the size of parameter variations
used in the linear expansion of the wavefunction. Its value must be
strictly between 0 and 1. A larger value results in larger variations.</p></li>
<li><p><strong>lindep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Linear dependency threshold to use when solving the generalized
eigenvalue problem.</p></li>
<li><p><strong>epsilon</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Increment to use for approximating the gradient using
finite difference.</p></li>
<li><p><strong>gtol</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Convergence threshold for the norm of the projected gradient.</p></li>
<li><p><strong>optimize_hyperparameters</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to optimize the <cite>regularization</cite> and
<cite>variation</cite> hyperparameters in each iteration. Optimizing the
hyperparameters incurs more function and energy evaluations in each
iteration, but may speed up convergence, leading to fewer iterations
overall. The optimization is performed using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a>.</p></li>
<li><p><strong>optimize_hyperparameters_args</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span>) – <p>Arguments to use when calling
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a> to optimize the hyperparameters. The call is
constructed as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="o">**</span><span class="n">scipy_optimize_minimize_args</span><span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>callback</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]</span>) – <p>A callable called after each iteration. It is called with the
signature</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">callback</span><span class="p">(</span><span class="n">intermediate_result</span><span class="p">:</span> <span class="n">OptimizeResult</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">intermediate_result</span></code> is a <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult">scipy.optimize.OptimizeResult</a>
with attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>  and <code class="docutils literal notranslate"><span class="pre">fun</span></code>, the present values of the parameter
vector and objective function. For all iterations except for the last,
it also contains the <code class="docutils literal notranslate"><span class="pre">jac</span></code> attribute holding the present value of the
gradient, as well as <code class="docutils literal notranslate"><span class="pre">regularization</span></code> and <code class="docutils literal notranslate"><span class="pre">variation</span></code> attributes
holding the present values of the <cite>regularization</cite> and <cite>variation</cite>
hyperparameters.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The optimization result represented as a <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult">scipy.optimize.OptimizeResult</a>
object. Note the following definitions of selected attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>: The final parameters of the optimization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code>: The energy associated with the final parameters. That is, the
expectation value of the Hamiltonian with respect to the state vector
corresponding to the parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nfev</span></code>: The number of times the <code class="docutils literal notranslate"><span class="pre">params_to_vec</span></code> function was called.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nlinop</span></code>: The number of times the <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> linear operator was
applied to a vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ffsim</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/01-introduction.html">Introduction to ffsim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/02-orbital-rotation.html">Orbital rotations and quadratic Hamiltonians</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/03-double-factorized.html">Diagonal Coulomb operators and double-factorized Trotter simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/04-lucj.html">The local unitary cluster Jastrow (LUCJ) ansatz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/05-entanglement-forging.html">Entanglement forging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/06-fermion-operator.html">The FermionOperator class</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ffsim.html">ffsim</a></li>
<li class="toctree-l1"><a class="reference internal" href="ffsim.contract.html">ffsim.contract</a></li>
<li class="toctree-l1"><a class="reference internal" href="ffsim.linalg.html">ffsim.linalg</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ffsim.optimize</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ffsim.optimize.minimize_linear_method"><code class="docutils literal notranslate"><span class="pre">minimize_linear_method()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ffsim.random.html">ffsim.random</a></li>
<li class="toctree-l1"><a class="reference internal" href="ffsim.testing.html">ffsim.testing</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="ffsim.linalg.html" title="previous chapter">ffsim.linalg</a></li>
      <li>Next: <a href="ffsim.random.html" title="next chapter">ffsim.random</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023, IBM.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.15</a>
      
      |
      <a href="../_sources/api/ffsim.optimize.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>